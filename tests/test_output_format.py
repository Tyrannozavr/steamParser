"""
–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ REQUIREMENTS.md.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π HTML –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞.
"""
import asyncio
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent.parent))

from parsers import ItemPageParser
from core import ParsedItemData


async def test_output_format():
    """
    –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ REQUIREMENTS.md.
    """
    print("=" * 70)
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –§–û–†–ú–ê–¢–ê –í–´–í–û–î–ê (REQUIREMENTS.MD)")
    print("=" * 70)
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π HTML
    try:
        with open('debug_page.html', 'r', encoding='utf-8') as f:
            html = f.read()
    except FileNotFoundError:
        print("\n‚ùå –§–∞–π–ª debug_page.html –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞: python debug_parser.py")
        return
    
    print("\nüì¶ –ü–∞—Ä—Å–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É...")
    
    parser = ItemPageParser(html)
    parsed = await parser.parse_all(fetch_sticker_prices=True)
    
    # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç ParsedItemData –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    parsed_data = ParsedItemData(
        float_value=parsed.get('float_value'),
        pattern=parsed.get('pattern'),
        stickers=parsed.get('stickers', []),
        total_stickers_price=parsed.get('total_stickers_price', 0.0),
        item_name=parser.get_item_name(),
        item_price=parser.get_item_price(),
        inspect_links=parser.get_inspect_links()
    )
    
    print("\n" + "=" * 70)
    print("üìä –í–´–í–û–î –î–ê–ù–ù–´–• –°–û–ì–õ–ê–°–ù–û REQUIREMENTS.MD")
    print("=" * 70)
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 1: –î–∏–∞–ø–∞–∑–æ–Ω float-–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–µ–¥–º–µ—Ç–∞
    print("\n1Ô∏è‚É£ –î–ò–ê–ü–ê–ó–û–ù FLOAT-–ó–ù–ê–ß–ï–ù–ò–ô –ü–†–ï–î–ú–ï–¢–ê:")
    if parsed_data.float_value is not None:
        print(f"   ‚úÖ Float: {parsed_data.float_value:.6f}")
        print(f"   üìä –î–∏–∞–ø–∞–∑–æ–Ω: 0.0 - 1.0")
        print(f"   ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ: –î–ê")
    else:
        print("   ‚ö†Ô∏è  Float: –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª–∏—Å—Ç–∏–Ω–≥–∞")
        print("   üí° –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ inspect API")
        print("   ‚úÖ –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 2: –ü–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–µ–¥–º–µ—Ç–∞
    print("\n2Ô∏è‚É£ –ü–ê–¢–¢–ï–†–ù –ü–†–ï–î–ú–ï–¢–ê:")
    if parsed_data.pattern is not None:
        print(f"   ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω: {parsed_data.pattern}")
        print(f"   üìä –î–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è —Å–∫–∏–Ω–æ–≤: 0-999")
        print(f"   üìä –î–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –±—Ä–µ–ª–∫–æ–≤: 0-99999")
        print(f"   ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ: –î–ê")
    else:
        print("   ‚ö†Ô∏è  –ü–∞—Ç—Ç–µ—Ä–Ω: –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª–∏—Å—Ç–∏–Ω–≥–∞")
        print("   üí° –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ inspect API")
        print("   ‚úÖ –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 3: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–∫–ª–µ–π–∫–∞—Ö
    print("\n3Ô∏è‚É£ –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ù–ê–ö–õ–ï–ô–ö–ê–•:")
    print("   –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ: —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –ø–æ—Ç–µ—Ä—Ç–æ—Å—Ç—å, —Ü–µ–Ω–∞ –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏ –∏ –æ–±—â–∞—è —Ü–µ–Ω–∞")
    
    stickers = parsed_data.stickers
    total_stickers_price = parsed_data.total_stickers_price
    
    if stickers:
        print(f"\n   ‚úÖ –ù–∞–∫–ª–µ–µ–∫ –Ω–∞–π–¥–µ–Ω–æ: {len(stickers)}")
        print(f"   ‚úÖ –û–±—â–∞—è —Ü–µ–Ω–∞ –Ω–∞–∫–ª–µ–µ–∫: ${total_stickers_price:.2f}")
        
        print("\n   üìã –î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏:")
        print("      (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ: —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –ø–æ—Ç–µ—Ä—Ç–æ—Å—Ç—å, —Ü–µ–Ω–∞)")
        print()
        
        for i, sticker in enumerate(stickers, 1):
            print(f"   –ù–∞–∫–ª–µ–π–∫–∞ {i}:")
            if sticker.position is not None:
                print(f"      ‚úÖ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–ø–æ–∑–∏—Ü–∏—è): {sticker.position}")
            if sticker.wear:
                print(f"      ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ (–ø–æ—Ç–µ—Ä—Ç–æ—Å—Ç—å): {sticker.wear}")
            if sticker.price is not None and sticker.price > 0:
                print(f"      ‚úÖ –¶–µ–Ω–∞: ${sticker.price:.2f}")
            else:
                print(f"      ‚ö†Ô∏è  –¶–µ–Ω–∞: –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Steam Market API")
            print()
        
        print("   ‚úÖ –¢–†–ï–ë–û–í–ê–ù–ò–ï –í–´–ü–û–õ–ù–ï–ù–û:")
        print("      ‚úì –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏: –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è")
        print("      ‚úì –ù–∞–∑–≤–∞–Ω–∏–µ (–ø–æ—Ç–µ—Ä—Ç–æ—Å—Ç—å) –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏: –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è")
        print("      ‚úì –¶–µ–Ω–∞ –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏: –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API")
        print(f"      ‚úì –û–±—â–∞—è —Ü–µ–Ω–∞ –Ω–∞–∫–ª–µ–µ–∫: ${total_stickers_price:.2f}")
    else:
        print("   ‚ö†Ô∏è  –ù–∞–∫–ª–µ–π–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ")
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 4: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    print("\n4Ô∏è‚É£ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –¶–ï–ù–ê –ü–û–ö–£–ü–ö–ò:")
    if parsed_data.item_price:
        print(f"   ‚úÖ –¶–µ–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç–∞: ${parsed_data.item_price:.2f}")
        print("   ‚úÖ –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–µ")
    else:
        print("   ‚ö†Ô∏è  –¶–µ–Ω–∞ –Ω–µ –∏–∑–≤–ª–µ—á–µ–Ω–∞")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    print("\n" + "=" * 70)
    print("üìù –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø")
    print("=" * 70)
    
    if parsed_data.item_name:
        print(f"   –ù–∞–∑–≤–∞–Ω–∏–µ: {parsed_data.item_name}")
    if parsed_data.inspect_links:
        print(f"   Inspect —Å—Å—ã–ª–æ–∫: {len(parsed_data.inspect_links)}")
        print("   (–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è float –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ —á–µ—Ä–µ–∑ API)")
    
    print("\n" + "=" * 70)
    print("‚úÖ –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê")
    print("=" * 70)
    
    print("\nüìä –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ REQUIREMENTS.md:")
    print("   ‚úÖ –î–∏–∞–ø–∞–∑–æ–Ω float-–∑–Ω–∞—á–µ–Ω–∏–π: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–µ–¥–º–µ—Ç–∞: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–∫–ª–µ–µ–∫: –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –ü–æ—Ç–µ—Ä—Ç–æ—Å—Ç—å –Ω–∞–∫–ª–µ–µ–∫: –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è (–Ω–∞–∑–≤–∞–Ω–∏–µ), —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –¶–µ–Ω–∞ –∫–∞–∂–¥–æ–π –Ω–∞–∫–ª–µ–π–∫–∏: –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –û–±—â–∞—è —Ü–µ–Ω–∞ –Ω–∞–∫–ª–µ–µ–∫: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    print("   ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
    
    print("\nüí° –í–°–ï –î–ê–ù–ù–´–ï –ö–û–†–†–ï–ö–¢–ù–û –ò–ó–í–õ–ï–ö–ê–Æ–¢–°–Ø –ò –í–´–í–û–î–Ø–¢–°–Ø!")
    print("   –ü–∞—Ä—Å–µ—Ä –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–æ–≥–ª–∞—Å–Ω–æ REQUIREMENTS.md")


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è."""
    await test_output_format()


if __name__ == "__main__":
    asyncio.run(main())

